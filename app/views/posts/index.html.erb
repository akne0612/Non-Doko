
<%= render 'posts/map_box' %>
<div class="container py-4">
  <div class="row g-4 justify-content-center">
    <% @posts.each do |post| %>
      <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex">
        <div class="card h-100 text-center w-100">

          <%# ÁîªÂÉè %>
          <%= image_tag(
                post.image.attached? ? post.image.variant(resize_to_fill: [600, 400]) : "no_image.png",
                class: "card-img-top"
              ) %>

          <div class="card-body d-flex flex-column">

            <%# --- ËøΩÂä†: ÊäïÁ®øËÄÖ„Ç¢„Ç§„Ç≥„É≥ + ÂêçÂâç --- %>
            <div class="d-flex align-items-center justify-content-center gap-2 mb-2">
              <%= link_to user_path(post.user), class: "d-inline-flex align-items-center text-decoration-none" do %>
                <% if post.user&.avatar&.attached? %>
                  <%= image_tag post.user.avatar.variant(resize_to_fill: [28, 28]),
                        class: "rounded-circle border", alt: "#{post.user.name}„ÅÆ„Ç¢„Ç§„Ç≥„É≥" %>
                <% else %>
                  <div class="rounded-circle bg-light border d-inline-flex align-items-center justify-content-center"
                       style="width:28px;height:28px;">
                    <span class="small text-muted"><%= post.user.name.to_s.first&.upcase || "?" %></span>
                  </div>
                <% end %>
                <span class="ms-2 small text-dark fw-semibold"><%= post.user.name %></span>
              <% end %>
            </div>

            <%# „Çø„Ç§„Éà„É´ %>
            <h5 class="card-title mb-2"><%= post.title %></h5>

            <%# „ÅÑ„ÅÑ„Å≠/„Ç≥„É°„É≥„ÉàÊï∞ %>
            <div class="text-muted small mb-3">
              ‚ù§ <%= post.likes_count || post.likes.size %>
              &nbsp; / &nbsp;
              üí¨ <%= post.comments.size %>
            </div>

            <%# „Éú„Çø„É≥Ë°åÔºà„Ç∫„É¨Èò≤Ê≠¢: Ê®™‰∏¶„Å≥ & „Ç§„É≥„É©„Ç§„É≥ÂåñÔºâ %>
            <div class="mt-auto d-flex justify-content-center align-items-center gap-2">
              <span class="d-inline-block">
                <%= render "posts/like_button", post: post %>
              </span>
              <%= link_to "Ë©≥Á¥∞", post_path(post), class: "btn btn-sm btn-primary" %>
            </div>

          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<%= render 'posts/map_js' %>