<!DOCTYPE html>
<html>
  <head>
    <title>NonDoko</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

   
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoYz1DhKrrGqQh6bU8qU5s1mZl+PBh6rZ9E+vW9CKMpJQ6N"
      crossorigin="anonymous"
    />

   
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js" integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS" crossorigin="anonymous"></script>

    <!-- Webpacker（必要ならそのまま） -->
    <%= stylesheet_pack_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag  'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body class="d-flex flex-column min-vh-100">
    <!-- Header -->
    <header>
      <nav class="navbar navbar-expand-lg navbar-light" style="background-color:#EF8134;">
        <div class="container">
          <!-- ブランド -->
          <%= link_to root_path, class: "navbar-brand d-flex align-items-center" do %>
            <%= image_tag "logo.jpg", alt: "呑んどこ!", height: 80, class: "rounded" %>
          <% end %>

        
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                  aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <!-- メニュー -->
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto align-items-lg-center">
              <% if user_signed_in? %>
                <li class="nav-item me-2">
                  <span class="navbar-text text-dark">
                    こんにちは、
                    <%= link_to (current_user.name.presence || "あなた"), user_path(current_user),
                          class: "text-decoration-none fw-semibold text-dark" %> さん
                  </span>
                </li>
                <li class="nav-item"><%= link_to 'お店を探す', shops_path,     class: "nav-link text-dark" %></li>
                <li class="nav-item"><%= link_to '投稿一覧',   posts_path,     class: "nav-link text-dark" %></li>
                <li class="nav-item"><%= link_to '新規投稿',   new_post_path,  class: "nav-link text-dark" %></li>
                <li class="nav-item"><%= link_to 'ログアウト', destroy_user_session_path, method: :delete, class: "nav-link text-dark" %></li>
                <li class="nav-item">
                  <%= link_to "退会する", user_registration_path,
                        method: :delete,
                        data: { confirm: "本当に退会しますか？\n投稿やコメントも削除されます。" },
                        class: "nav-link text-danger" %>
                </li>
              <% else %>
                <li class="nav-item"><%= link_to 'アバウト',   homes_about_path,         class: "nav-link text-dark" %></li>
                <li class="nav-item"><%= link_to 'ログイン',   new_user_session_path,    class: "nav-link text-dark" %></li>
                <li class="nav-item"><%= link_to '新規登録',   new_user_registration_path, class: "nav-link text-dark" %></li>
              <% end %>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Flash（中央寄せ） -->
    <div class="container mt-3">
      <% if notice.present? %>
        <div class="alert alert-success text-center"><%= notice %></div>
      <% end %>
      <% if alert.present? %>
        <div class="alert alert-danger text-center"><%= alert %></div>
      <% end %>
    </div>

    <!-- Main -->
    <main class="flex-fill">
      <div class="container py-4">
        <%= yield %>
      </div>
    </main>

    <!-- Footer -->
    <footer class="text-center mt-auto py-3 text-muted" style="font-size:0.9rem;">
      <% if admin_signed_in? %>
        <%= link_to "管理画面トップ", admin_root_path, class: "text-decoration-none" %>
        &nbsp;|&nbsp;
        <%= link_to "管理者ログアウト", destroy_admin_session_path, method: :delete, class: "text-decoration-none" %>
      <% else %>
        <%= link_to "管理者はこちら", new_admin_session_path, class: "text-decoration-none" %>
      <% end %>
    </footer>
  </body>
